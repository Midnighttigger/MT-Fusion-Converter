from PIL import Image
def Gen(ti,base):
    dase = int(base/2)
    f1 = ti.crop((0,0,dase,dase))
    f2 = ti.crop((dase,0,base,dase))
    f3 = ti.crop((base,0,dase*3,dase))
    f4 = ti.crop((dase*3,0,base*2,dase))
    f5 = ti.crop((base*2,0,dase*5,dase))
    f6 = ti.crop((dase*5,0,base*3,dase))
    f7 = ti.crop((base*3,0,dase*7,dase))
    f8 = ti.crop((dase*7,0,base*4,dase))
    f9 = ti.crop((base*4,0,dase*9,dase))
    f10 = ti.crop((dase*9,0,base*5,dase))
    f11 = ti.crop((0,dase,dase,base))
    f12 = ti.crop((dase,dase,base,base))
    f13 = ti.crop((base,dase,dase*3,base))
    f14 = ti.crop((dase*3,dase,base*2,base))
    f15 = ti.crop((base*2,dase,dase*5,base))
    f16 = ti.crop((dase*5,dase,base*3,base))
    f17 = ti.crop((base*3,dase,dase*7,base))
    f18 = ti.crop((dase*7,dase,base*4,base))
    f19 = ti.crop((base*4,dase,dase*9,base))
    f20 = ti.crop((dase*9,dase,base*5,base))
    tf = Image.new("RGBA",(base*8,base*8))
    tf.paste(f1,(0,0))
    tf.paste(f2,(dase,0))
    tf.paste(f1,(base,0))
    tf.paste(f8,(dase*3,0))
    tf.paste(f7,(base*2,0))
    tf.paste(f8,(dase*5,0))
    tf.paste(f7,(base*3,0))
    tf.paste(f2,(dase*7,0))
    tf.paste(f1,(base*4,0))
    tf.paste(f8,(dase*9,0))
    tf.paste(f7,(base*5,0))
    tf.paste(f2,(dase*11,0))
    tf.paste(f5,(base*6,0))
    tf.paste(f10,(dase*13,0))
    tf.paste(f7,(base*7,0))
    tf.paste(f8,(dase*15,0))
    tf.paste(f11,(0,dase))
    tf.paste(f12,(dase,dase))
    tf.paste(f11,(base,dase))
    tf.paste(f18,(dase*3,dase))
    tf.paste(f17,(base*2,dase))
    tf.paste(f18,(dase*5,dase))
    tf.paste(f17,(base*3,dase))
    tf.paste(f12,(dase*7,dase))
    tf.paste(f15,(base*4,dase))
    tf.paste(f20,(dase*9,dase))
    tf.paste(f19,(base*5,dase))
    tf.paste(f16,(dase*11,dase))
    tf.paste(f15,(base*6,dase))
    tf.paste(f20,(dase*13,dase))
    tf.paste(f19,(base*7,dase))
    tf.paste(f20,(dase*15,dase))
    tf.paste(f1,(0,base))
    tf.paste(f2,(dase,base))
    tf.paste(f1,(base,base))
    f1.close()
    tf.paste(f8,(dase*3,base))
    tf.paste(f7,(base*2,base))
    tf.paste(f8,(dase*5,base))
    tf.paste(f7,(base*3,base))
    tf.paste(f2,(dase*7,base))
    f2.close()
    tf.paste(f5,(base*4,base))
    tf.paste(f10,(dase*9,base))
    tf.paste(f9,(base*5,base))
    tf.paste(f6,(dase*11,base))
    tf.paste(f9,(base*6,base))
    tf.paste(f10,(dase*13,base))
    tf.paste(f9,(base*7,base))
    tf.paste(f6,(dase*15,base))
    tf.paste(f15,(0,dase*3))
    tf.paste(f16,(dase,dase*3))
    tf.paste(f15,(base,dase*3))
    tf.paste(f14,(dase*3,dase*3))
    tf.paste(f13,(base*2,dase*3))
    tf.paste(f14,(dase*5,dase*3))
    tf.paste(f13,(base*3,dase*3))
    tf.paste(f16,(dase*7,dase*3))
    tf.paste(f11,(base*4,dase*3))
    tf.paste(f18,(dase*9,dase*3))
    tf.paste(f17,(base*5,dase*3))
    tf.paste(f12,(dase*11,dase*3))
    tf.paste(f17,(base*6,dase*3))
    tf.paste(f18,(dase*13,dase*3))
    tf.paste(f19,(base*7,dase*3))
    tf.paste(f16,(dase*15,dase*3))
    tf.paste(f5,(0,base*2))
    tf.paste(f6,(dase,base*2))
    tf.paste(f5,(base,base*2))
    tf.paste(f4,(dase*3,base*2))
    tf.paste(f3,(base*2,base*2))
    tf.paste(f4,(dase*5,base*2))
    tf.paste(f3,(base*3,base*2))
    tf.paste(f6,(dase*7,base*2))
    tf.paste(f5,(base*4,base*2))
    tf.paste(f4,(dase*9,base*2))
    tf.paste(f7,(base*5,base*2))
    tf.paste(f8,(dase*11,base*2))
    tf.paste(f5,(base*6,base*2))
    tf.paste(f10,(dase*13,base*2))
    tf.paste(f7,(base*7,base*2))
    f7.close()
    tf.paste(f8,(dase*15,base*2))
    f8.close()
    tf.paste(f15,(0,dase*5))
    tf.paste(f16,(dase,dase*5))
    tf.paste(f15,(base,dase*5))
    tf.paste(f14,(dase*3,dase*5))
    tf.paste(f13,(base*2,dase*5))
    tf.paste(f14,(dase*5,dase*5))
    tf.paste(f13,(base*3,dase*5))
    tf.paste(f16,(dase*7,dase*5))
    tf.paste(f15,(base*4,dase*5))
    tf.paste(f20,(dase*9,dase*5))
    tf.paste(f19,(base*5,dase*5))
    tf.paste(f14,(dase*11,dase*5))
    tf.paste(f15,(base*6,dase*5))
    f15.close()
    tf.paste(f14,(dase*13,dase*5))
    tf.paste(f13,(base*7,dase*5))
    tf.paste(f20,(dase*15,dase*5))
    tf.paste(f5,(0,base*3))
    tf.paste(f6,(dase,base*3))
    tf.paste(f5,(base,base*3))
    f5.close()
    tf.paste(f4,(dase*3,base*3))
    tf.paste(f3,(base*2,base*3))
    tf.paste(f4,(dase*5,base*3))
    tf.paste(f3,(base*3,base*3))
    tf.paste(f6,(dase*7,base*3))
    tf.paste(f3,(base*4,base*3))
    tf.paste(f10,(dase*9,base*3))
    tf.paste(f9,(base*5,base*3))
    tf.paste(f6,(dase*11,base*3))
    tf.paste(f9,(base*6,base*3))
    tf.paste(f4,(dase*13,base*3))
    tf.paste(f3,(base*7,base*3))
    tf.paste(f6,(dase*15,base*3))
    f6.close()
    tf.paste(f11,(0,dase*7))
    tf.paste(f12,(dase,dase*7))
    tf.paste(f11,(base,dase*7))
    f11.close()
    tf.paste(f18,(dase*3,dase*7))
    tf.paste(f17,(base*2,dase*7))
    tf.paste(f18,(dase*5,dase*7))
    tf.paste(f17,(base*3,dase*7))
    tf.paste(f12,(dase*7,dase*7))
    f12.close()
    tf.paste(f17,(base*4,dase*7))
    tf.paste(f18,(dase*9,dase*7))
    tf.paste(f13,(base*5,dase*7))
    tf.paste(f16,(dase*11,dase*7))
    tf.paste(f17,(base*6,dase*7))
    f17.close()
    tf.paste(f18,(dase*13,dase*7))
    f18.close()
    tf.paste(f19,(base*7,dase*7))
    tf.paste(f16,(dase*15,dase*7))
    f16.close()
    tf.paste(f9,(0,base*4))
    tf.paste(f4,(dase,base*4))
    tf.paste(f9,(base,base*4))
    tf.paste(f10,(dase*3,base*4))
    tf.paste(f9,(base*2,base*4))
    tf.paste(f4,(dase*5,base*4))
    tf.paste(f9,(base*3,base*4))
    tf.paste(f10,(dase*7,base*4))
    tf.paste(f9,(base*4,base*4))
    tf.paste(f10,(dase*9,base*4))
    tf.paste(f9,(base*5,base*4))
    tf.paste(f10,(dase*11,base*4))
    tf.paste(f3,(base*6,base*4))
    tf.paste(f4,(dase*13,base*4))
    tf.paste(f3,(base*7,base*4))
    tf.paste(f4,(dase*15,base*4))
    tf.paste(f13,(0,dase*9))
    tf.paste(f20,(dase,dase*9))
    tf.paste(f19,(base,dase*9))
    tf.paste(f20,(dase*3,dase*9))
    tf.paste(f19,(base*2,dase*9))
    tf.paste(f14,(dase*5,dase*9))
    tf.paste(f13,(base*3,dase*9))
    tf.paste(f14,(dase*7,dase*9))
    tf.paste(f19,(base*4,dase*9))
    tf.paste(f14,(dase*9,dase*9))
    tf.paste(f13,(base*5,dase*9))
    tf.paste(f20,(dase*11,dase*9))
    tf.paste(f13,(base*6,dase*9))
    tf.paste(f20,(dase*13,dase*9))
    tf.paste(f19,(base*7,dase*9))
    tf.paste(f14,(dase*15,dase*9))
    tf.paste(f3,(0,base*5))
    tf.paste(f10,(dase,base*5))
    tf.paste(f3,(base*2,base*5))
    tf.paste(f4,(dase*5,base*5))
    tf.paste(f3,(base*3,base*5))
    tf.paste(f10,(dase*7,base*5))
    tf.paste(f9,(base*4,base*5))
    tf.paste(f4,(dase*9,base*5))
    tf.paste(f3,(base*5,base*5))
    tf.paste(f10,(dase*11,base*5))
    tf.paste(f3,(base*6,base*5))
    f3.close()
    tf.paste(f10,(dase*13,base*5))
    f10.close()
    tf.paste(f9,(base*7,base*5))
    f9.close()
    tf.paste(f4,(dase*15,base*5))
    f4.close()
    tf.paste(f19,(0,dase*11))
    tf.paste(f14,(dase,dase*11))
    tf.paste(f19,(base*2,dase*11))
    tf.paste(f20,(dase*5,dase*11))
    tf.paste(f13,(base*3,dase*11))
    tf.paste(f20,(dase*7,dase*11))
    tf.paste(f19,(base*4,dase*11))
    tf.paste(f20,(dase*9,dase*11))
    tf.paste(f19,(base*5,dase*11))
    f19.close()
    tf.paste(f20,(dase*11,dase*11))
    f20.close()
    tf.paste(f13,(base*6,dase*11))
    tf.paste(f14,(dase*13,dase*11))
    tf.paste(f13,(base*7,dase*11))
    f13.close()
    tf.paste(f14,(dase*15,dase*11))
    f14.close()
    return tf
def GenAdv(ti,ti2,base):
    dase = int(base/2)
    f1 = ti.crop((0,0,base,base))
    f2 = ti.crop((base,0,base*2,base))
    f3 = ti.crop((base*2,0,base*3,base))
    f4 = ti.crop((base*3,0,base*4,base))
    f5 = ti.crop((0,base,base,base*2))
    f6 = ti.crop((base,base,base*2,base*2))
    f7 = ti.crop((base*2,base,base*3,base*2))
    f8 = ti.crop((base*3,base,base*4,base*2))
    f9 = ti.crop((0,base,base*5,base*2))
    f10 = ti.crop((base,base*2,base*2,base*3))
    f11 = ti.crop((base*2,base*2,base*3,base*3))
    f12 = ti.crop((base*3,base*2,base*4,base*3))
    f13 = ti.crop((0,base*3,base,base*4))
    f14 = ti.crop((base,base*3,base*2,base*4))
    f15 = ti.crop((base*2,base*3,base*3,base*4))
    f16 = ti.crop((base*3,base*3,base*4,base*4))
    ti.close()
    f17 = ti2.crop((0,0,dase,dase))
    f18 = ti2.crop((dase,0,base,dase))
    f19 = ti2.crop((0,dase,dase,base))
    f20 = ti2.crop((dase,dase,base,base))
    ti2.close()
    tf = Image.new("RGBA",(base*8,base*8))
    tf.paste(f1,(0,0))
    f1.close()
    tf.paste(f7,(base,0))
    f7.close()
    tf.paste(f5,(base*2,0))
    tf.paste(f4,(base*3,0))
    f4.close()
    tf.paste(f11,(base*4,0))
    tf.paste(f12,(base*5,0))
    tf.paste(f9,(base*6,0))
    tf.paste(f10,(base*7,0))
    tf.paste(f3,(0,base))
    f3.close()
    tf.paste(f11,(base,base))
    tf.paste(f20,(dase*3,dase*3))
    f11.close()
    tf.paste(f5,(base*2,base))
    tf.paste(f19,(base*2,dase*3))
    tf.paste(f20,(dase*5,dase*3))
    tf.paste(f12,(base*3,base))
    tf.paste(f19,(base*3,dase*3))
    f12.close()
    tf.paste(f15,(base*4,base))
    tf.paste(f16,(base*5,base))
    tf.paste(f13,(base*6,base))
    tf.paste(f14,(base*7,base))
    tf.paste(f6,(0,base*2))
    tf.paste(f6,(base,base*2))
    tf.paste(f18,(dase*3,base*2))
    tf.paste(f20,(dase*3,dase*5))
    tf.paste(f17,(base*2,base*2))
    tf.paste(f18,(dase*5,base*2))
    tf.paste(f19,(base*2,dase*5))
    tf.paste(f20,(dase*5,dase*5))
    tf.paste(f6,(base*3,base*2))
    tf.paste(f17,(base*3,base*2))
    tf.paste(f19,(base*3,dase*7))
    f6.close()
    tf.paste(f9,(base*4,base*2))
    tf.paste(f18,(dase*9,base*2))
    tf.paste(f10,(base*5,base*2))
    tf.paste(f20,(dase*11,dase*5))
    tf.paste(f9,(base*6,base*2))
    tf.paste(f20,(dase*13,dase*5))
    f9.close()
    tf.paste(f10,(base*7,base*2))
    tf.paste(f19,(dase*15,dase*5))
    f10.close()
    tf.paste(f8,(0,base*3))
    f8.close()
    tf.paste(f15,(base,base*3))
    tf.paste(f18,(dase*3,base*3))
    f15.close()
    tf.paste(f5,(base*2,base*3))
    tf.paste(f17,(base*2,base*3))
    tf.paste(f18,(dase*5,base*3))
    f5.close()
    tf.paste(f16,(base*3,base*3))
    tf.paste(f17,(base*3,base*3))
    f16.close()
    tf.paste(f13,(base*4,base*3))
    tf.paste(f17,(base*4,base*3))
    tf.paste(f14,(base*5,base*3))
    tf.paste(f19,(base*5,dase*7))
    tf.paste(f13,(base*6,base*3))
    tf.paste(f18,(dase*13,base*3))
    f13.close()
    tf.paste(f14,(base*7,base*3))
    tf.paste(f18,(base*7,base*3))
    f14.close()
    tf.paste(f2,(0,base*4))
    tf.paste(f18,(dase,base*4))
    tf.paste(f19,(0,dase*9))
    tf.paste(f2,(base,base*4))
    tf.paste(f2,(base*2,base*4))
    tf.paste(f18,(dase*5,base*4))
    tf.paste(f20,(dase*5,dase*9))
    tf.paste(f2,(base*3,base*4))
    tf.paste(f17,(base*3,dase*9))
    tf.paste(f18,(dase*7,dase*9))
    tf.paste(f2,(base*4,base*4))
    tf.paste(f20,(dase*9,dase*9))
    tf.paste(f2,(base*5,base*4))
    tf.paste(f19,(base*5,dase*9))
    tf.paste(f2,(base*6,base*4))
    tf.paste(f17,(base*6,base*4))
    tf.paste(f18,(dase*13,base*4))
    tf.paste(f19,(base*6,dase*9))
    tf.paste(f2,(base*7,base*4))
    tf.paste(f17,(base*7,base*4))
    tf.paste(f18,(dase*15,base*4))
    tf.paste(f20,(dase*15,dase*9))
    tf.paste(f2,(0,base*5))
    tf.paste(f17,(0,base*5))
    tf.paste(f20,(dase,dase*11))
    tf.paste(f2,(base*2,base*5))
    tf.paste(f17,(base*2,base*5))
    tf.paste(f18,(dase*5,base*5))
    tf.paste(f2,(base*3,base*5))
    tf.paste(f17,(base*3,base*5))
    tf.paste(f19,(base*3,dase*11))
    tf.paste(f2,(base*4,base*5))
    tf.paste(f18,(dase*9,base*5))
    tf.paste(f2,(base*5,base*5))
    tf.paste(f17,(base*5,base*5))
    tf.paste(f2,(base*6,base*5))
    tf.paste(f17,(base*6,base*5))
    f17.close()
    tf.paste(f19,(base*6,dase*11))
    tf.paste(f20,(dase*13,dase*11))
    tf.paste(f2,(base*7,base*5))
    f2.close()
    tf.paste(f18,(dase*15,base*5))
    f18.close()
    tf.paste(f19,(base*7,dase*11))
    f19.close()
    tf.paste(f20,(dase*15,dase*11))
    f20.close()
    return tf
def Full(base,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13,f14,f15,f16,f17,f18,f19,f20,f21,f22,f23,f24,f25,f26,f27,f28,f29,f30,f31,f32,f33,f34,f35,f36,f37,f38,f39,f40,f41,f42,f43,f44,f45,f46):
    tf = Image.new("RGBA",(base*8,base*8))
    tf.paste(f0,(0,0))
    f0.close()
    tf.paste(f1,(base,0))
    f1.close()
    tf.paste(f2,(base*2,0))
    f2.close()
    tf.paste(f3,(base*3,0))
    f3.close()
    tf.paste(f4,(base*4,0))
    f4.close()
    tf.paste(f5,(base*5,0))
    f5.close()
    tf.paste(f6,(base*6,0))
    f6.close()
    tf.paste(f7,(base*7,0))
    f7.close()
    tf.paste(f8,(0,base))
    f8.close()
    tf.paste(f9,(base,base))
    f9.close()
    tf.paste(f10,(base*2,base))
    f10.close()
    tf.paste(f11,(base*3,base))
    f11.close()
    tf.paste(f12,(base*4,base))
    f12.close()
    tf.paste(f13,(base*5,base))
    f13.close()
    tf.paste(f14,(base*6,base))
    f14.close()
    tf.paste(f15,(base*7,base))
    f15.close()
    tf.paste(f16,(0,base*2))
    f16.close()
    tf.paste(f17,(base,base*2))
    f17.close()
    tf.paste(f18,(base*2,base*2))
    f18.close()
    tf.paste(f19,(base*3,base*2))
    f19.close()
    tf.paste(f20,(base*4,base*2))
    f20.close()
    tf.paste(f21,(base*5,base*2))
    f21.close()
    tf.paste(f22,(base*6,base*2))
    f22.close()
    tf.paste(f23,(base*7,base*2))
    f23.close()
    tf.paste(f24,(0,base*3))
    f24.close()
    tf.paste(f25,(base,base*3))
    f25.close()
    tf.paste(f26,(base*2,base*3))
    f26.close()
    tf.paste(f27,(base*3,base*3))
    f27.close()
    tf.paste(f28,(base*4,base*3))
    f28.close()
    tf.paste(f29,(base*5,base*3))
    f29.close()
    tf.paste(f30,(base*6,base*3))
    f30.close()
    tf.paste(f31,(base*7,base*3))
    f31.close()
    tf.paste(f32,(0,base*4))
    f32.close()
    tf.paste(f33,(base,base*4))
    f33.close()
    tf.paste(f34,(base*2,base*4))
    f34.close()
    tf.paste(f35,(base*3,base*4))
    f35.close()
    tf.paste(f36,(base*4,base*4))
    f36.close()
    tf.paste(f37,(base*5,base*4))
    f37.close()
    tf.paste(f38,(base*6,base*4))
    f38.close()
    tf.paste(f39,(base*7,base*4))
    f39.close()
    tf.paste(f40,(0,base*5))
    f40.close()
    tf.paste(f41,(base*2,base*5))
    f41.close()
    tf.paste(f42,(base*3,base*5))
    f42.close()
    tf.paste(f43,(base*4,base*5))
    f43.close()
    tf.paste(f44,(base*5,base*5))
    f44.close()
    tf.paste(f45,(base*6,base*5))
    f45.close()
    tf.paste(f46,(base*7,base*5))
    f46.close()
    return tf
def Loc(t0,base,loc)
    loclist = {"0":(0,0),"1":(1,0),"2":(2,0),"3":(3,0),"4":(4,0),"5":(5,0),"6":(6,0),"7":(7,0),"8":(0,1),"9":(1,1),"10":(2,1),"11":(3,1),"12":(4,1),"13":(5,1),"14":(6,1),"15":(7,1),"16":(0,2),"17":(1,2),"18":(2,2),"19":(3,2),"20":(4,2),"21":(5,2),"22":(6,2),"23":(7,2),"24":(0,3),"25":(1,3),"26":(2,3),"27":(3,3),"28":(4,3),"29":(5,3),"30":(6,3),"31":(7,3),"32":(0,4),"33":(1,4),"34":(2,4),"35":(3,4),"36":(4,4),"37":(5,4),"38":(6,4),"39":(7,4),"40":(0,5),"41":(2,5),"42":(3,5),"43":(4,5),"44":(5,5),"45":(6,5),"46":(7,5)}
    location = loclist[format(loc)]
    locx = location[0]
    locy = location[1]
    tf = t0.crop((locx*base,locy*base,locx*base+base,locy*base+base))
    t0.close()
    return tf
def Arrange(t0,base,CovList,exitx,exity)
    loclist = {"0":(0,0),"1":(1,0),"2":(2,0),"3":(3,0),"4":(4,0),"5":(5,0),"6":(6,0),"7":(7,0),"8":(0,1),"9":(1,1),"10":(2,1),"11":(3,1),"12":(4,1),"13":(5,1),"14":(6,1),"15":(7,1),"16":(0,2),"17":(1,2),"18":(2,2),"19":(3,2),"20":(4,2),"21":(5,2),"22":(6,2),"23":(7,2),"24":(0,3),"25":(1,3),"26":(2,3),"27":(3,3),"28":(4,3),"29":(5,3),"30":(6,3),"31":(7,3),"32":(0,4),"33":(1,4),"34":(2,4),"35":(3,4),"36":(4,4),"37":(5,4),"38":(6,4),"39":(7,4),"40":(0,5),"41":(2,5),"42":(3,5),"43":(4,5),"44":(5,5),"45":(6,5),"46":(7,5)}
    tf = Image.new("RGBA",(base*exitx,base*exity))
    for Loc in Covlist:
        croplist = loclist[format(Loc[0])]
        cropx = croplist[0]
        cropy = croplist[1]
        ti = t0.crop((cropx*base,cropy*base,cropx*base+base,cropy*base+base))
        pastelist = loclist[format(Loc[1])]
        pastex = pastelist[0]
        pastey = pastelist[1]
        tf.paste(ti,(pastex*base,pastey*base))
        ti.close()
    t0.close()
    return tf
    
